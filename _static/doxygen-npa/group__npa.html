<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>nPASmartCardLibrary: Interface to German identity card (neuer Personalausweis, nPA)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">nPASmartCardLibrary
   &#160;<span id="projectnumber">0.7</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Modules</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Interface to German identity card (neuer Personalausweis, nPA)</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga8687c3ac31f2755fb8d6e33a658ffaf1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga8687c3ac31f2755fb8d6e33a658ffaf1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga8687c3ac31f2755fb8d6e33a658ffaf1">NPA_BITMAP_PACE</a>&#160;&#160;&#160;0x40</td></tr>
<tr class="memdesc:ga8687c3ac31f2755fb8d6e33a658ffaf1"><td class="mdescLeft">&#160;</td><td class="mdescRight">NPA capabilities (TR-03119): PACE. <br /></td></tr>
<tr class="separator:ga8687c3ac31f2755fb8d6e33a658ffaf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga868d6f838352023addcec12cc63554d8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga868d6f838352023addcec12cc63554d8"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga868d6f838352023addcec12cc63554d8">NPA_BITMAP_EID</a>&#160;&#160;&#160;0x20</td></tr>
<tr class="memdesc:ga868d6f838352023addcec12cc63554d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">NPA capabilities (TR-03119): EPA: eID. <br /></td></tr>
<tr class="separator:ga868d6f838352023addcec12cc63554d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0e42036a0b5b8ae6a395242ef8b3564d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga0e42036a0b5b8ae6a395242ef8b3564d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga0e42036a0b5b8ae6a395242ef8b3564d">NPA_BITMAP_ESIGN</a>&#160;&#160;&#160;0x10</td></tr>
<tr class="memdesc:ga0e42036a0b5b8ae6a395242ef8b3564d"><td class="mdescLeft">&#160;</td><td class="mdescRight">NPA capabilities (TR-03119): EPA: eSign. <br /></td></tr>
<tr class="separator:ga0e42036a0b5b8ae6a395242ef8b3564d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga087892ab6cc489c0634f8acdfb7550fe"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga087892ab6cc489c0634f8acdfb7550fe"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga087892ab6cc489c0634f8acdfb7550fe">NPA_SUCCESS</a>&#160;&#160;&#160;0x00000000</td></tr>
<tr class="memdesc:ga087892ab6cc489c0634f8acdfb7550fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">NPA result (TR-03119): Kein Fehler. <br /></td></tr>
<tr class="separator:ga087892ab6cc489c0634f8acdfb7550fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa185f79debb5b657c8030c845817491f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaa185f79debb5b657c8030c845817491f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#gaa185f79debb5b657c8030c845817491f">NPA_ERROR_LENGTH_INCONSISTENT</a>&#160;&#160;&#160;0xD0000001</td></tr>
<tr class="memdesc:gaa185f79debb5b657c8030c845817491f"><td class="mdescLeft">&#160;</td><td class="mdescRight">NPA result (TR-03119): Längen im Input sind inkonsistent. <br /></td></tr>
<tr class="separator:gaa185f79debb5b657c8030c845817491f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacd713a5d7c6ec31799772407b014e660"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gacd713a5d7c6ec31799772407b014e660"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#gacd713a5d7c6ec31799772407b014e660">NPA_ERROR_UNEXPECTED_DATA</a>&#160;&#160;&#160;0xD0000002</td></tr>
<tr class="memdesc:gacd713a5d7c6ec31799772407b014e660"><td class="mdescLeft">&#160;</td><td class="mdescRight">NPA result (TR-03119): Unerwartete Daten im Input. <br /></td></tr>
<tr class="separator:gacd713a5d7c6ec31799772407b014e660"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabefe6ec1eafa6c52024f7cb5505dd446"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gabefe6ec1eafa6c52024f7cb5505dd446"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#gabefe6ec1eafa6c52024f7cb5505dd446">NPA_ERROR_UNEXPECTED_DATA_COMBINATION</a>&#160;&#160;&#160;0xD0000003</td></tr>
<tr class="memdesc:gabefe6ec1eafa6c52024f7cb5505dd446"><td class="mdescLeft">&#160;</td><td class="mdescRight">NPA result (TR-03119): Unerwartete Kombination von Daten im Input. <br /></td></tr>
<tr class="separator:gabefe6ec1eafa6c52024f7cb5505dd446"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab0ae94a359e6ca9ce57a959ee56e8d11"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gab0ae94a359e6ca9ce57a959ee56e8d11"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#gab0ae94a359e6ca9ce57a959ee56e8d11">NPA_ERROR_CARD_NOT_SUPPORTED</a>&#160;&#160;&#160;0xE0000001</td></tr>
<tr class="memdesc:gab0ae94a359e6ca9ce57a959ee56e8d11"><td class="mdescLeft">&#160;</td><td class="mdescRight">NPA result (TR-03119): Die Karte unterstützt das PACE – Verfahren nicht. (Unerwartete Struktur in Antwortdaten der Karte) <br /></td></tr>
<tr class="separator:gab0ae94a359e6ca9ce57a959ee56e8d11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac32808cf8f305dcc32a8c1f35146b6ba"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gac32808cf8f305dcc32a8c1f35146b6ba"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#gac32808cf8f305dcc32a8c1f35146b6ba">NPA_ERROR_ALGORITH_NOT_SUPPORTED</a>&#160;&#160;&#160;0xE0000002</td></tr>
<tr class="memdesc:gac32808cf8f305dcc32a8c1f35146b6ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">NPA result (TR-03119): Der Kartenleser unterstützt den angeforderten bzw. den ermittelten Algorithmus nicht. <br /></td></tr>
<tr class="separator:gac32808cf8f305dcc32a8c1f35146b6ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga636248c2b1f3cebfbbb3da6258c79823"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga636248c2b1f3cebfbbb3da6258c79823"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga636248c2b1f3cebfbbb3da6258c79823">NPA_ERROR_PINID_NOT_SUPPORTED</a>&#160;&#160;&#160;0xE0000003</td></tr>
<tr class="memdesc:ga636248c2b1f3cebfbbb3da6258c79823"><td class="mdescLeft">&#160;</td><td class="mdescRight">NPA result (TR-03119): Der Kartenleser kennt die PIN – ID nicht. <br /></td></tr>
<tr class="separator:ga636248c2b1f3cebfbbb3da6258c79823"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga09d627a9c54567e38d26fd1a2ae0271a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga09d627a9c54567e38d26fd1a2ae0271a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga09d627a9c54567e38d26fd1a2ae0271a">NPA_ERROR_SELECT_EF_CARDACCESS</a>&#160;&#160;&#160;0xF0000000</td></tr>
<tr class="memdesc:ga09d627a9c54567e38d26fd1a2ae0271a"><td class="mdescLeft">&#160;</td><td class="mdescRight">NPA result (TR-03119): Negative Antwort der Karte auf Select EF_CardAccess (needs to be OR-ed with SW1|SW2) <br /></td></tr>
<tr class="separator:ga09d627a9c54567e38d26fd1a2ae0271a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga55ded91813584bb175ecb8790ffd1b2c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga55ded91813584bb175ecb8790ffd1b2c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga55ded91813584bb175ecb8790ffd1b2c">NPA_ERROR_READ_BINARY</a>&#160;&#160;&#160;0xF0010000</td></tr>
<tr class="memdesc:ga55ded91813584bb175ecb8790ffd1b2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">NPA result (TR-03119): Negative Antwort der Karte auf Read Binary (needs to be OR-ed with SW1|SW2) <br /></td></tr>
<tr class="separator:ga55ded91813584bb175ecb8790ffd1b2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaed492828c39edbc4f0a7f35d447a61af"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaed492828c39edbc4f0a7f35d447a61af"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#gaed492828c39edbc4f0a7f35d447a61af">NPA_ERROR_MSE_SET_AT</a>&#160;&#160;&#160;0xF0020000</td></tr>
<tr class="memdesc:gaed492828c39edbc4f0a7f35d447a61af"><td class="mdescLeft">&#160;</td><td class="mdescRight">NPA result (TR-03119): Negative Antwort der Karte auf MSE: Set AT (needs to be OR-ed with SW1|SW2) <br /></td></tr>
<tr class="separator:gaed492828c39edbc4f0a7f35d447a61af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadac1fd4d6b333fc5ad8b373b0b08b3bf"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gadac1fd4d6b333fc5ad8b373b0b08b3bf"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#gadac1fd4d6b333fc5ad8b373b0b08b3bf">NPA_ERROR_GENERAL_AUTHENTICATE_1</a>&#160;&#160;&#160;0xF0030000</td></tr>
<tr class="memdesc:gadac1fd4d6b333fc5ad8b373b0b08b3bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">NPA result (TR-03119): Negative Antwort der Karte auf General Authenticate Step 1 (needs to be OR-ed with SW1|SW2) <br /></td></tr>
<tr class="separator:gadac1fd4d6b333fc5ad8b373b0b08b3bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8926b5f324e7a1c35a1620e75a509053"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga8926b5f324e7a1c35a1620e75a509053"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga8926b5f324e7a1c35a1620e75a509053">NPA_ERROR_GENERAL_AUTHENTICATE_2</a>&#160;&#160;&#160;0xF0040000</td></tr>
<tr class="memdesc:ga8926b5f324e7a1c35a1620e75a509053"><td class="mdescLeft">&#160;</td><td class="mdescRight">NPA result (TR-03119): Negative Antwort der Karte auf General Authenticate Step 2 (needs to be OR-ed with SW1|SW2) <br /></td></tr>
<tr class="separator:ga8926b5f324e7a1c35a1620e75a509053"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga636ddc6ba912f09dae124b2595289529"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga636ddc6ba912f09dae124b2595289529"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga636ddc6ba912f09dae124b2595289529">NPA_ERROR_GENERAL_AUTHENTICATE_3</a>&#160;&#160;&#160;0xF0050000</td></tr>
<tr class="memdesc:ga636ddc6ba912f09dae124b2595289529"><td class="mdescLeft">&#160;</td><td class="mdescRight">NPA result (TR-03119): Negative Antwort der Karte auf General Authenticate Step 3 (needs to be OR-ed with SW1|SW2) <br /></td></tr>
<tr class="separator:ga636ddc6ba912f09dae124b2595289529"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3d8b96222faed6525ddefad333b4fa58"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga3d8b96222faed6525ddefad333b4fa58"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga3d8b96222faed6525ddefad333b4fa58">NPA_ERROR_GENERAL_AUTHENTICATE_4</a>&#160;&#160;&#160;0xF0060000</td></tr>
<tr class="memdesc:ga3d8b96222faed6525ddefad333b4fa58"><td class="mdescLeft">&#160;</td><td class="mdescRight">NPA result (TR-03119): Negative Antwort der Karte auf General Authenticate Step 4 (needs to be OR-ed with SW1|SW2) <br /></td></tr>
<tr class="separator:ga3d8b96222faed6525ddefad333b4fa58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa4522f4ed8f1a4064ad6a497dcdb207d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaa4522f4ed8f1a4064ad6a497dcdb207d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#gaa4522f4ed8f1a4064ad6a497dcdb207d">NPA_ERROR_COMMUNICATION</a>&#160;&#160;&#160;0xF0100001</td></tr>
<tr class="memdesc:gaa4522f4ed8f1a4064ad6a497dcdb207d"><td class="mdescLeft">&#160;</td><td class="mdescRight">NPA result (TR-03119): Kommunikationsabbruch mit Karte. <br /></td></tr>
<tr class="separator:gaa4522f4ed8f1a4064ad6a497dcdb207d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga292fd995b31d160e2aed0ae9fa7b7a06"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga292fd995b31d160e2aed0ae9fa7b7a06"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga292fd995b31d160e2aed0ae9fa7b7a06">NPA_ERROR_NO_CARD</a>&#160;&#160;&#160;0xF0100002</td></tr>
<tr class="memdesc:ga292fd995b31d160e2aed0ae9fa7b7a06"><td class="mdescLeft">&#160;</td><td class="mdescRight">NPA result (TR-03119): Keine Karte im Feld. <br /></td></tr>
<tr class="separator:ga292fd995b31d160e2aed0ae9fa7b7a06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabcc370fa7402f6268de3503e7b35877d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gabcc370fa7402f6268de3503e7b35877d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#gabcc370fa7402f6268de3503e7b35877d">NPA_ERROR_ABORTED</a>&#160;&#160;&#160;0xF0200001</td></tr>
<tr class="memdesc:gabcc370fa7402f6268de3503e7b35877d"><td class="mdescLeft">&#160;</td><td class="mdescRight">NPA result (TR-03119): Benutzerabbruch. <br /></td></tr>
<tr class="separator:gabcc370fa7402f6268de3503e7b35877d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9175e13aafeaeda29fbdb183d82e31d0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga9175e13aafeaeda29fbdb183d82e31d0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga9175e13aafeaeda29fbdb183d82e31d0">NPA_ERROR_TIMEOUT</a>&#160;&#160;&#160;0xF0200002</td></tr>
<tr class="memdesc:ga9175e13aafeaeda29fbdb183d82e31d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">NPA result (TR-03119): Benutzer – Timeout. <br /></td></tr>
<tr class="separator:ga9175e13aafeaeda29fbdb183d82e31d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2cdd6624ca4866f8408acf7ad1ba5348"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga2cdd6624ca4866f8408acf7ad1ba5348"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga2cdd6624ca4866f8408acf7ad1ba5348">FID_EF_CARDACCESS</a>&#160;&#160;&#160;0x011C</td></tr>
<tr class="memdesc:ga2cdd6624ca4866f8408acf7ad1ba5348"><td class="mdescLeft">&#160;</td><td class="mdescRight">File identifier of EF.CardAccess. <br /></td></tr>
<tr class="separator:ga2cdd6624ca4866f8408acf7ad1ba5348"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga46adfcee8778feb03c97f201b6f81d56"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga46adfcee8778feb03c97f201b6f81d56"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga46adfcee8778feb03c97f201b6f81d56">SFID_EF_CARDACCESS</a>&#160;&#160;&#160;0x1C</td></tr>
<tr class="memdesc:ga46adfcee8778feb03c97f201b6f81d56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Short file identifier of EF.CardAccess. <br /></td></tr>
<tr class="separator:ga46adfcee8778feb03c97f201b6f81d56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0e6c8a0681ca8f3470770f7a4931aafc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga0e6c8a0681ca8f3470770f7a4931aafc"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga0e6c8a0681ca8f3470770f7a4931aafc">FID_EF_CARDSECURITY</a>&#160;&#160;&#160;0x011D</td></tr>
<tr class="memdesc:ga0e6c8a0681ca8f3470770f7a4931aafc"><td class="mdescLeft">&#160;</td><td class="mdescRight">File identifier of EF.CardSecurity. <br /></td></tr>
<tr class="separator:ga0e6c8a0681ca8f3470770f7a4931aafc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2d1501393a0c711ee3e62615d581704c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga2d1501393a0c711ee3e62615d581704c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga2d1501393a0c711ee3e62615d581704c">SFID_EF_CARDSECURITY</a>&#160;&#160;&#160;0x1D</td></tr>
<tr class="memdesc:ga2d1501393a0c711ee3e62615d581704c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Short file identifier of EF.CardAccess. <br /></td></tr>
<tr class="separator:ga2d1501393a0c711ee3e62615d581704c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5800c331c1758c17b6b910eaf4e7d926"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga5800c331c1758c17b6b910eaf4e7d926"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga5800c331c1758c17b6b910eaf4e7d926">MAX_PIN_LEN</a>&#160;&#160;&#160;6</td></tr>
<tr class="memdesc:ga5800c331c1758c17b6b910eaf4e7d926"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum length of PIN. <br /></td></tr>
<tr class="separator:ga5800c331c1758c17b6b910eaf4e7d926"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga75855f0eba570caff1d47746b361aa50"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga75855f0eba570caff1d47746b361aa50"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga75855f0eba570caff1d47746b361aa50">MIN_PIN_LEN</a>&#160;&#160;&#160;6</td></tr>
<tr class="memdesc:ga75855f0eba570caff1d47746b361aa50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimum length of PIN. <br /></td></tr>
<tr class="separator:ga75855f0eba570caff1d47746b361aa50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga511c9cc4b62ba8c134c5e6bf29494601"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga511c9cc4b62ba8c134c5e6bf29494601"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga511c9cc4b62ba8c134c5e6bf29494601">CAN_LEN</a>&#160;&#160;&#160;6</td></tr>
<tr class="memdesc:ga511c9cc4b62ba8c134c5e6bf29494601"><td class="mdescLeft">&#160;</td><td class="mdescRight">Length of CAN. <br /></td></tr>
<tr class="separator:ga511c9cc4b62ba8c134c5e6bf29494601"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa4947ea910f356f8c475e21915c79e67"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaa4947ea910f356f8c475e21915c79e67"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#gaa4947ea910f356f8c475e21915c79e67">MAX_MRZ_LEN</a>&#160;&#160;&#160;128</td></tr>
<tr class="memdesc:gaa4947ea910f356f8c475e21915c79e67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimum length of MRZ. <br /></td></tr>
<tr class="separator:gaa4947ea910f356f8c475e21915c79e67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga13cd49060b837cdeec525781ac0c0621"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga13cd49060b837cdeec525781ac0c0621"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga13cd49060b837cdeec525781ac0c0621">MAX_PIN_TRIES</a>&#160;&#160;&#160;3</td></tr>
<tr class="memdesc:ga13cd49060b837cdeec525781ac0c0621"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of retries for PIN. <br /></td></tr>
<tr class="separator:ga13cd49060b837cdeec525781ac0c0621"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaad974df3d72aa79c13f9e042cef7261f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaad974df3d72aa79c13f9e042cef7261f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#gaad974df3d72aa79c13f9e042cef7261f">UC_PIN_SUSPENDED</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:gaad974df3d72aa79c13f9e042cef7261f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Usage counter of PIN in suspended state. <br /></td></tr>
<tr class="separator:gaad974df3d72aa79c13f9e042cef7261f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac48a5e211dbe2e4129b1b05cc5323aaa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#gac48a5e211dbe2e4129b1b05cc5323aaa">npa_unblock_pin</a>(card)&#160;&#160;&#160;<a class="el" href="group__npa.html#ga4c7507f8f35c39d4d24766d51fb868cb">npa_reset_retry_counter</a>(card, PACE_PIN, 0, NULL, 0)</td></tr>
<tr class="memdesc:gac48a5e211dbe2e4129b1b05cc5323aaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send APDU to unblock the PIN.  <a href="#gac48a5e211dbe2e4129b1b05cc5323aaa">More...</a><br /></td></tr>
<tr class="separator:gac48a5e211dbe2e4129b1b05cc5323aaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab81a918e060f80ac74c26b15222a092a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#gab81a918e060f80ac74c26b15222a092a">npa_change_pin</a>(card, newp, newplen)&#160;&#160;&#160;<a class="el" href="group__npa.html#ga4c7507f8f35c39d4d24766d51fb868cb">npa_reset_retry_counter</a>(card, PACE_PIN, 1, newp, newplen)</td></tr>
<tr class="memdesc:gab81a918e060f80ac74c26b15222a092a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send APDU to set a new PIN.  <a href="#gab81a918e060f80ac74c26b15222a092a">More...</a><br /></td></tr>
<tr class="separator:gab81a918e060f80ac74c26b15222a092a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga16f7efc7f640063be6ea0af3ac834034"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga16f7efc7f640063be6ea0af3ac834034"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga16f7efc7f640063be6ea0af3ac834034">NPA_FLAG_DISABLE_CHECK_ALL</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:ga16f7efc7f640063be6ea0af3ac834034"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable all sanity checks done by libnpa. <br /></td></tr>
<tr class="separator:ga16f7efc7f640063be6ea0af3ac834034"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3b8a1978b2d121bf2be0aec6fb9eec56"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga3b8a1978b2d121bf2be0aec6fb9eec56"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga3b8a1978b2d121bf2be0aec6fb9eec56">NPA_FLAG_DISABLE_CHECK_TA</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:ga3b8a1978b2d121bf2be0aec6fb9eec56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable checking validity period of CV certificates. <br /></td></tr>
<tr class="separator:ga3b8a1978b2d121bf2be0aec6fb9eec56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf8aaca03d794fa79ffe63815d2995b97"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaf8aaca03d794fa79ffe63815d2995b97"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#gaf8aaca03d794fa79ffe63815d2995b97">NPA_FLAG_DISABLE_CHECK_CA</a>&#160;&#160;&#160;4</td></tr>
<tr class="memdesc:gaf8aaca03d794fa79ffe63815d2995b97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable checking passive authentication during CA. <br /></td></tr>
<tr class="separator:gaf8aaca03d794fa79ffe63815d2995b97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaf1a3f74c045e7a815368a9bb6b08b353"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#gaf1a3f74c045e7a815368a9bb6b08b353">npa_secret_name</a> (enum s_type pin_id)</td></tr>
<tr class="memdesc:gaf1a3f74c045e7a815368a9bb6b08b353"><td class="mdescLeft">&#160;</td><td class="mdescRight">Names the type of the PACE secret.  <a href="#gaf1a3f74c045e7a815368a9bb6b08b353">More...</a><br /></td></tr>
<tr class="separator:gaf1a3f74c045e7a815368a9bb6b08b353"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabc7481da778211ffcaa8e682bc6f5938"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#gabc7481da778211ffcaa8e682bc6f5938">get_pace_capabilities</a> (u8 *bitmap)</td></tr>
<tr class="memdesc:gabc7481da778211ffcaa8e682bc6f5938"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the PACE capabilities.  <a href="#gabc7481da778211ffcaa8e682bc6f5938">More...</a><br /></td></tr>
<tr class="separator:gabc7481da778211ffcaa8e682bc6f5938"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaadfcaf886bcf7bfeaaa79d5fd9547819"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#gaadfcaf886bcf7bfeaaa79d5fd9547819">perform_pace</a> (sc_card_t *card, struct establish_pace_channel_input pace_input, struct establish_pace_channel_output *pace_output, enum eac_tr_version tr_version)</td></tr>
<tr class="memdesc:gaadfcaf886bcf7bfeaaa79d5fd9547819"><td class="mdescLeft">&#160;</td><td class="mdescRight">Establish secure messaging using PACE.  <a href="#gaadfcaf886bcf7bfeaaa79d5fd9547819">More...</a><br /></td></tr>
<tr class="separator:gaadfcaf886bcf7bfeaaa79d5fd9547819"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga152ddd07cb17a0a6b6236cb070cb2660"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga152ddd07cb17a0a6b6236cb070cb2660">perform_terminal_authentication</a> (sc_card_t *card, const unsigned char **certs, const size_t *certs_lens, const unsigned char *privkey, size_t privkey_len, const unsigned char *auxiliary_data, size_t auxiliary_data_len)</td></tr>
<tr class="memdesc:ga152ddd07cb17a0a6b6236cb070cb2660"><td class="mdescLeft">&#160;</td><td class="mdescRight">Terminal Authentication version 2.  <a href="#ga152ddd07cb17a0a6b6236cb070cb2660">More...</a><br /></td></tr>
<tr class="separator:ga152ddd07cb17a0a6b6236cb070cb2660"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga193e21a171980fcc0d65e86d887652d6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga193e21a171980fcc0d65e86d887652d6">perform_chip_authentication</a> (sc_card_t *card, unsigned char **ef_cardsecurity, size_t *ef_cardsecurity_len)</td></tr>
<tr class="memdesc:ga193e21a171980fcc0d65e86d887652d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Establish secure messaging using Chip Authentication version 2.  <a href="#ga193e21a171980fcc0d65e86d887652d6">More...</a><br /></td></tr>
<tr class="separator:ga193e21a171980fcc0d65e86d887652d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4c7507f8f35c39d4d24766d51fb868cb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga4c7507f8f35c39d4d24766d51fb868cb">npa_reset_retry_counter</a> (sc_card_t *card, enum s_type pin_id, int ask_for_secret, const char *new, size_t new_len)</td></tr>
<tr class="memdesc:ga4c7507f8f35c39d4d24766d51fb868cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a reset retry counter APDU.  <a href="#ga4c7507f8f35c39d4d24766d51fb868cb">More...</a><br /></td></tr>
<tr class="separator:ga4c7507f8f35c39d4d24766d51fb868cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga246a724aa74d40b87d635758878aa2a6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga246a724aa74d40b87d635758878aa2a6">npa_pace_get_tries_left</a> (sc_card_t *card, enum s_type pin_id, int *tries_left)</td></tr>
<tr class="memdesc:ga246a724aa74d40b87d635758878aa2a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends an MSE:Set AT to determine the number of remaining tries.  <a href="#ga246a724aa74d40b87d635758878aa2a6">More...</a><br /></td></tr>
<tr class="separator:ga246a724aa74d40b87d635758878aa2a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6ff3d929a1c1a0dda3e64409c4f19b34"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga6ff3d929a1c1a0dda3e64409c4f19b34"></a>
typedef&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#ga6ff3d929a1c1a0dda3e64409c4f19b34">STACK_OF</a> (CVC_DISCRETIONARY_DATA_TEMPLATE) ASN1_AUXILIARY_DATA</td></tr>
<tr class="memdesc:ga6ff3d929a1c1a0dda3e64409c4f19b34"><td class="mdescLeft">&#160;</td><td class="mdescRight">ASN.1 type for authenticated auxiliary data for terminal authentication. <br /></td></tr>
<tr class="separator:ga6ff3d929a1c1a0dda3e64409c4f19b34"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:gaca889ab000cf62e52bfb9b97a6428b8f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaca889ab000cf62e52bfb9b97a6428b8f"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__npa.html#gaca889ab000cf62e52bfb9b97a6428b8f">npa_default_flags</a></td></tr>
<tr class="memdesc:gaca889ab000cf62e52bfb9b97a6428b8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use <code>npa_default_flags</code> to disable checks for EAC/SM. <br /></td></tr>
<tr class="separator:gaca889ab000cf62e52bfb9b97a6428b8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="gab81a918e060f80ac74c26b15222a092a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define npa_change_pin</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">card, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">newp, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">newplen&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="group__npa.html#ga4c7507f8f35c39d4d24766d51fb868cb">npa_reset_retry_counter</a>(card, PACE_PIN, 1, newp, newplen)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send APDU to set a new PIN. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">card</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">newp</td><td>(optional) new PIN </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">newplen</td><td>(optional) length of <em>new</em> </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gac48a5e211dbe2e4129b1b05cc5323aaa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define npa_unblock_pin</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">card</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="group__npa.html#ga4c7507f8f35c39d4d24766d51fb868cb">npa_reset_retry_counter</a>(card, PACE_PIN, 0, NULL, 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send APDU to unblock the PIN. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">card</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gabc7481da778211ffcaa8e682bc6f5938"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_pace_capabilities </td>
          <td>(</td>
          <td class="paramtype">u8 *&#160;</td>
          <td class="paramname"><em>bitmap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the PACE capabilities. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bitmap</td><td>where to store capabilities bitmap </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Since this code offers no support for terminal certificate, the bitmap is always <code>PACE_BITMAP_PACE|PACE_BITMAP_EID</code> </dd></dl>
<dl class="section return"><dt>Returns</dt><dd><code>SC_SUCCESS</code> or error code if an error occurred </dd></dl>

</div>
</div>
<a class="anchor" id="ga246a724aa74d40b87d635758878aa2a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int npa_pace_get_tries_left </td>
          <td>(</td>
          <td class="paramtype">sc_card_t *&#160;</td>
          <td class="paramname"><em>card</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum s_type&#160;</td>
          <td class="paramname"><em>pin_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>tries_left</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends an MSE:Set AT to determine the number of remaining tries. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">card</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pin_id</td><td>Type of secret (usually PIN or CAN). You may use <code>enum s_type</code> from <code>&lt;openssl/pace.h&gt;</code>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tries_left</td><td>Tries left or -1 if no specific number has been returned by the card (e.g. when there is no limit in retries).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>SC_SUCCESS</code> or error code if an error occurred </dd></dl>

</div>
</div>
<a class="anchor" id="ga4c7507f8f35c39d4d24766d51fb868cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int npa_reset_retry_counter </td>
          <td>(</td>
          <td class="paramtype">sc_card_t *&#160;</td>
          <td class="paramname"><em>card</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum s_type&#160;</td>
          <td class="paramname"><em>pin_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ask_for_secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>new_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends a reset retry counter APDU. </p>
<p>According to TR-03110 the reset retry counter APDU is used to set a new PIN or to reset the retry counter of the PIN. The standard requires this operation to be authorized either by an established PACE channel or by the effective authorization of the terminal's certificate.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">card</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pin_id</td><td>Type of secret (usually PIN or CAN). You may use <code>enum s_type</code> from <code>&lt;openssl/pace.h&gt;</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ask_for_secret</td><td>whether to ask the user for the secret (<code>1</code>) or not (<code>0</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">new</td><td>(optional) new secret </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">new_len</td><td>(optional) length of <em>new</em> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>SC_SUCCESS</code> or error code if an error occurred </dd></dl>

</div>
</div>
<a class="anchor" id="gaf1a3f74c045e7a815368a9bb6b08b353"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* npa_secret_name </td>
          <td>(</td>
          <td class="paramtype">enum s_type&#160;</td>
          <td class="paramname"><em>pin_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Names the type of the PACE secret. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pin_id</td><td>type of the PACE secret</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Printable string containing the name </dd></dl>

</div>
</div>
<a class="anchor" id="ga193e21a171980fcc0d65e86d887652d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int perform_chip_authentication </td>
          <td>(</td>
          <td class="paramtype">sc_card_t *&#160;</td>
          <td class="paramname"><em>card</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char **&#160;</td>
          <td class="paramname"><em>ef_cardsecurity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>ef_cardsecurity_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Establish secure messaging using Chip Authentication version 2. </p>
<p>Switches the SM context of <code>card</code> to the new established keys.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">card</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ef_cardsecurity</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ef_cardsecurity_len</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>SC_SUCCESS</code> or error code if an error occurred </dd></dl>

</div>
</div>
<a class="anchor" id="gaadfcaf886bcf7bfeaaa79d5fd9547819"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int perform_pace </td>
          <td>(</td>
          <td class="paramtype">sc_card_t *&#160;</td>
          <td class="paramname"><em>card</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct establish_pace_channel_input&#160;</td>
          <td class="paramname"><em>pace_input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct establish_pace_channel_output *&#160;</td>
          <td class="paramname"><em>pace_output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum eac_tr_version&#160;</td>
          <td class="paramname"><em>tr_version</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Establish secure messaging using PACE. </p>
<p>Modifies <em>card</em> to use the ISO SM driver and initializes the data structures to use the established SM channel.</p>
<p>Prints certificate description and card holder authorization template if given in a human readable form to stdout. If no secret is given, the user is asked for it. Only <em>pace_input.pin_id</em> is mandatory, the other members of <em>pace_input</em> can be set to <code>0</code> or <code>NULL</code> respectively.</p>
<p>The buffers in <em>pace_output</em> are allocated using <code>realloc()</code> and should be set to NULL, if empty. If an EF.CardAccess is already present, this file is reused and not fetched from the card.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">card</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pace_input</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pace_output</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tr_version</td><td>Version of TR-03110 to use with PACE</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>SC_SUCCESS</code> or error code if an error occurred </dd></dl>

</div>
</div>
<a class="anchor" id="ga152ddd07cb17a0a6b6236cb070cb2660"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int perform_terminal_authentication </td>
          <td>(</td>
          <td class="paramtype">sc_card_t *&#160;</td>
          <td class="paramname"><em>card</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char **&#160;</td>
          <td class="paramname"><em>certs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t *&#160;</td>
          <td class="paramname"><em>certs_lens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>privkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>privkey_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>auxiliary_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>auxiliary_data_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Terminal Authentication version 2. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">card</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">certs</td><td>chain of cv certificates, the last certificate is the terminal's certificate, array should be terminated with <code>NULL</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">certs_lens</td><td>length of each element in <code>certs</code>, should be terminated with <code>0</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">privkey</td><td>The terminal's private key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">privkey_len</td><td>length of <em>privkey</em> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">auxiliary_data</td><td>auxiliary data for age/validity/community ID verification. Should be an ASN1 object tagged with <code>0x67</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">auxiliary_data_len</td><td>length of <em>auxiliary_data</em> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>SC_SUCCESS</code> or error code if an error occurred </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Dec 28 2015 01:41:52 for nPASmartCardLibrary by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
